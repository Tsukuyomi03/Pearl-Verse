<!-- Modern Flat Design Bottom Navigation - Pearl Verse -->
<!-- Inter Font - Modern, clean, and highly readable -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<!-- Font Awesome Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-Avb2QiuDEEvB4bZJYdft2mNjVShBftLdPG8FJ0V7irTLQ8Uo0qcPxh4Plq7G5tGm0rU+1SPhVotteLpBERwTkw==" crossorigin="anonymous">

<style>
    /* Global font settings for botnav with enhanced readability */
    .botnav, .botnav *, .botnav-item, .botnav-label {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        font-variant-numeric: tabular-nums;
        font-feature-settings: "cv02", "cv03", "cv04", "cv11";
        text-rendering: optimizeLegibility;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        font-optical-sizing: auto;
    }
    
    /* Enhanced typography for mobile-first navigation */
    .botnav-label {
        font-size: 0.75rem; /* 12px */
        font-weight: 600;
        line-height: 1.3;
        letter-spacing: -0.01em;
        margin-top: 0.3rem;
        text-align: center;
        color: inherit;
        text-transform: none;
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .botnav-icon {
        font-size: 1.25rem; /* 20px */
        font-weight: 500;
        margin-bottom: 0.125rem;
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        line-height: 1;
        /* CRITICAL: Remove all square constraints */
        width: auto !important;
        height: auto !important;
        min-width: unset !important;
        min-height: unset !important;
        max-width: none !important;
        max-height: none !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        box-sizing: content-box !important;
    }
    
    /* CRITICAL: Fix Font Awesome icons from being square */
    .botnav-icon i {
        width: auto !important;
        height: auto !important;
        min-width: 0 !important;
        min-height: 0 !important;
        max-width: none !important;
        max-height: none !important;
        border: none !important;
        background: none !important;
        border-radius: 0 !important;
        box-shadow: none !important;
        padding: 0 !important;
        margin: 0 !important;
        display: inline-block !important;
        font-family: "Font Awesome 6 Free", "Font Awesome 6 Brands" !important;
        font-weight: 900 !important;
        font-style: normal !important;
        line-height: 1 !important;
        text-rendering: auto !important;
        -webkit-font-smoothing: antialiased !important;
        box-sizing: content-box !important;
    }
    
    /* Override any universal selectors that might affect icons */
    .botnav i[class^="fa-"],
    .botnav i[class*=" fa-"],
    .botnav .fas,
    .botnav .far,
    .botnav .fab {
        width: auto !important;
        height: auto !important;
        border: none !important;
        background: none !important;
        display: inline-block !important;
    }
    
    /* Enhanced interaction states */
    .botnav-item {
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        border-radius: 16px;
        padding: 0.625rem 0.5rem;
        position: relative;
        overflow: hidden;
    }
    
    .botnav-item:hover .botnav-label {
        font-weight: 700;
        transform: translateY(-2px);
        letter-spacing: -0.015em;
    }
    
    .botnav-item:hover .botnav-icon {
        transform: scale(1.15);
    }
    
    .botnav-item.active .botnav-label {
        font-weight: 700;
        font-size: 0.8125rem; /* 13px */
        letter-spacing: -0.015em;
    }
    
    .botnav-item.active .botnav-icon {
        transform: scale(1.1);
    }
    
    /* Optimized responsive typography for touch interfaces */
    @media (max-width: 768px) {
        .botnav-label {
            font-size: 0.6875rem; /* 11px */
            font-weight: 600;
            margin-top: 0.25rem;
        }
        
        .botnav-item.active .botnav-label {
            font-size: 0.75rem; /* 12px */
            font-weight: 700;
        }
        
        .botnav-icon {
            font-size: 1.1875rem; /* 19px */
        }
        
        .botnav-item {
            padding: 0.5rem 0.375rem;
            border-radius: 14px;
        }
    }
    
    @media (max-width: 480px) {
        .botnav-label {
            font-size: 0.625rem; /* 10px */
            font-weight: 600;
            letter-spacing: 0;
            margin-top: 0.2rem;
        }
        
        .botnav-item.active .botnav-label {
            font-size: 0.6875rem; /* 11px */
            font-weight: 700;
        }
        
        .botnav-icon {
            font-size: 1.125rem; /* 18px */
        }
        
        .botnav-item {
            padding: 0.4375rem 0.3125rem;
            border-radius: 12px;
        }
    }
    
    /* Extra small screens - optimized for minimal space */
    @media (max-width: 360px) {
        .botnav-label {
            font-size: 0.5625rem; /* 9px */
            margin-top: 0.1875rem;
            font-weight: 600;
        }
        
        .botnav-item.active .botnav-label {
            font-size: 0.625rem; /* 10px */
        }
        
        .botnav-icon {
            font-size: 1rem; /* 16px */
        }
        
        .botnav-item {
            padding: 0.375rem 0.25rem;
            border-radius: 10px;
        }
    }
    
    /* Very small screens - consider hiding labels on tap */
    @media (max-width: 320px) {
        .botnav-label {
            font-size: 0.5rem; /* 8px */
            opacity: 0.9;
        }
        
        .botnav-item:active .botnav-label {
            opacity: 1;
        }
    }
    
    /* Core Bottom Navigation Layout and Positioning */
    .botnav {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: rgba(15, 23, 42, 0.95);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        z-index: 1000;
        display: none; /* Hidden by default */
        box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
    }
    
    /* Show on mobile devices */
    @media (max-width: 1023px) {
        .botnav {
            display: block;
        }
    }
    
    .botnav-container {
        padding: 0.5rem 0;
        max-width: 100vw;
        margin: 0 auto;
    }
    
    .botnav-items {
        display: flex;
        justify-content: space-around;
        align-items: center;
        gap: 0.25rem;
        padding: 0 0.5rem;
    }
    
    .botnav-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: #94a3b8;
        text-decoration: none;
        cursor: pointer;
        min-height: 3.5rem;
        flex: 1;
        max-width: 4rem;
        text-align: center;
    }
    
    .botnav-item:hover {
        color: #06b6d4;
        background: rgba(6, 182, 212, 0.1);
    }
    
    .botnav-item.active {
        color: #06b6d4;
        background: linear-gradient(135deg, rgba(6, 182, 212, 0.15), rgba(59, 130, 246, 0.1));
    }
    
    .botnav-indicator {
        position: absolute;
        bottom: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 0;
        height: 2px;
        background: linear-gradient(90deg, #06b6d4, #3b82f6);
        border-radius: 1px 1px 0 0;
        transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .botnav-item.active .botnav-indicator {
        width: 24px;
    }
    
    /* Ensure proper spacing for small screens */
    @media (max-width: 480px) {
        .botnav-container {
            padding: 0.375rem 0;
        }
        
        .botnav-items {
            gap: 0.125rem;
            padding: 0 0.25rem;
        }
        
        .botnav-item {
            min-height: 3.25rem;
            max-width: 3.5rem;
        }
    }
    
    @media (max-width: 360px) {
        .botnav-item {
            min-height: 3rem;
            max-width: 3.25rem;
        }
    }
</style>

<nav class="botnav" id="botnav" role="navigation" aria-label="Mobile navigation">
    <div class="botnav-container">
        <div class="botnav-items">
            <a href="/dashboard" class="botnav-item" data-nav="dashboard" 
               role="link" aria-label="Dashboard">
                <div class="botnav-icon">
                    <i class="fas fa-chart-line" aria-hidden="true"></i>
                </div>
                <span class="botnav-label">Dashboard</span>
                <div class="botnav-indicator" aria-hidden="true"></div>
            </a>
            
            <a href="/pearl_avatar_shop" class="botnav-item" data-nav="avatar-shop" 
               role="link" aria-label="Avatar Shop">
                <div class="botnav-icon">
                    <i class="fas fa-user-astronaut" aria-hidden="true"></i>
                </div>
                <span class="botnav-label">Avatar</span>
                <div class="botnav-indicator" aria-hidden="true"></div>
            </a>
            
            <a href="/pearl_market" class="botnav-item" data-nav="pearl-market" 
               role="link" aria-label="Pearl Market">
                <div class="botnav-icon">
                    <i class="fas fa-gem" aria-hidden="true"></i>
                </div>
                <span class="botnav-label">Pearl Market</span>
                <div class="botnav-indicator" aria-hidden="true"></div>
            </a>
            
            <a href="/inventory" class="botnav-item" data-nav="inventory" 
               role="link" aria-label="Your Inventory">
                <div class="botnav-icon">
                    <i class="fas fa-box-archive" aria-hidden="true"></i>
                </div>
                <span class="botnav-label">Inventory</span>
                <div class="botnav-indicator" aria-hidden="true"></div>
            </a>
            
            <a href="/community" class="botnav-item" data-nav="community" 
               role="link" aria-label="Community Hub">
                <div class="botnav-icon">
                    <i class="fas fa-users" aria-hidden="true"></i>
                </div>
                <span class="botnav-label">Community</span>
                <div class="botnav-indicator" aria-hidden="true"></div>
            </a>
            
            <a href="/leaderboard" class="botnav-item" data-nav="leaderboard" 
               role="link" aria-label="Player Leaderboard">
                <div class="botnav-icon">
                    <i class="fas fa-ranking-star" aria-hidden="true"></i>
                </div>
                <span class="botnav-label">Leaderboard</span>
                <div class="botnav-indicator" aria-hidden="true"></div>
            </a>
        </div>
    </div>
</nav>

<script>
// Bottom Navigation JavaScript
(function() {
    'use strict';
    
    // Initialize bottom navigation functionality
    function initializeBottomNav() {
        const navItems = document.querySelectorAll('.botnav-item');
        
        if (navItems.length === 0) {
            console.warn('Bottom navigation items not found');
            return;
        }
        
        // Set active navigation item based on current page
        const currentPath = window.location.pathname;
        navItems.forEach(item => {
            item.classList.remove('active');
            const href = item.getAttribute('href');
            if (href && (currentPath === href || (href !== '/' && currentPath.startsWith(href)))) {
                item.classList.add('active');
            }
        });
        
        // Handle navigation item clicks
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                // Update active state
                navItems.forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');
                
                // Add click animation
                this.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    this.style.transform = '';
                }, 150);
            });
            
            // Add touch feedback for mobile devices
            item.addEventListener('touchstart', function() {
                this.style.opacity = '0.7';
            });
            
            item.addEventListener('touchend', function() {
                this.style.opacity = '';
            });
        });
    }
    
    // Initialize when DOM is loaded
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initializeBottomNav);
    } else {
        initializeBottomNav();
    }
    
    // Also initialize after a short delay for dynamic content
    setTimeout(initializeBottomNav, 100);
})();
</script>
